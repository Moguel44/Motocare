<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#22d3ee">
<title>MotoCare</title>
<link rel="manifest" href="manifest.json">

<style>
:root{
  --bg:#0b1220;
  --card:#020617;
  --accent:#7dd3fc;
  --border:#1e293b;
}
body{
  margin:0;
  padding:16px;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
  background:var(--bg);
  color:#e5e7eb;
}
.header{text-align:center;margin-bottom:20px}
.logo-big{width:110px;height:110px;border-radius:22px}
h1{color:var(--accent);margin:10px 0 0}
.card{
  max-width:720px;
  margin:0 auto 20px;
  padding:20px;
  background:rgba(2,6,23,.95);
  border-radius:18px;
}
.hidden{display:none}
input,textarea,select{
  width:100%;
  margin-top:12px;
  padding:14px;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:12px;
  color:#e5e7eb;
}
.actions{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
  margin-top:18px;
}
button.primary{
  padding:14px;
  border-radius:22px;
  border:2px solid transparent;
  background:
    linear-gradient(#020617,#020617) padding-box,
    linear-gradient(135deg,#c9a227,#7c3aed) border-box;
  color:#fff;
  font-weight:600;
}
button.danger{
  background:#991b1b;
  color:#fff;
  border:none;
  padding:6px 10px;
  border-radius:12px;
  cursor:pointer;
}

/* Checklist */
.check-item{
  display:grid;
  grid-template-columns:26px 1fr;
  gap:12px;
  margin:10px 0;
  align-items:center;
}
.check-item input{width:20px;height:20px;margin:0}
.check-item span{text-align:left;line-height:1.4}

/* Toast */
.toast{
  position:fixed;
  bottom:24px;
  left:50%;
  transform:translateX(-50%);
  background:#020617;
  border:1px solid var(--border);
  padding:14px 18px;
  border-radius:16px;
  opacity:0;
  transition:.3s;
}
.toast.show{opacity:1}
.toast.error{border-color:#dc2626}
</style>
</head>

<body>

<div class="header">
  <img src="Mi_Man.png" class="logo-big">
  <h1>MotoCare</h1>
</div>

<!-- HOME -->
<div id="home" class="card">
  <h2>Motos registradas</h2>
  <ul id="listaMotos" style="list-style:none;padding:0"></ul>
  <div class="actions">
    <button class="primary" id="btnMoto">â• Moto</button>
    <button class="primary" id="btnMantenimiento">ğŸ› ï¸ Mantenimiento</button>
  </div>
  <button class="primary" style="margin-top:12px" id="btnHistorial">ğŸ“œ Historial</button>
</div>

<!-- MOTO -->
<div id="moto" class="card hidden">
  <h2>Tu moto</h2>
  <input id="marca" placeholder="Marca">
  <input id="modelo" placeholder="Modelo">
  <input id="anio" placeholder="AÃ±o">
  <input id="cilindrada" placeholder="Cilindrada">
  <input id="neumaticos" placeholder="NeumÃ¡ticos">
  <label>Fecha ITV</label>
  <input id="itv" type="date">
  <div class="actions">
    <button class="primary" id="guardarMoto">ğŸ’¾ Guardar</button>
    <button class="primary" id="volverMoto">â¬…ï¸ Volver</button>
  </div>
</div>

<!-- MANTENIMIENTO -->
<div id="mantenimiento" class="card hidden">
  <h2>Mantenimiento</h2>

  <label>Moto</label>
  <select id="motoSeleccionada"></select>

  <input id="km" placeholder="KilÃ³metros">
  <label>Fecha mantenimiento</label>
  <input id="fecha" type="date">
  <textarea id="obs" placeholder="Observaciones"></textarea>
  <textarea id="pendiente" placeholder="Pendiente / por hacer"></textarea>

  <h3>ğŸ›¢ï¸ Motor y transmisiÃ³n</h3>
  <label class="check-item"><input type="checkbox" value="Aceite"><span>Cambio de aceite</span></label>
  <label class="check-item"><input type="checkbox" value="FiltroAceite"><span>Filtro de aceite</span></label>
  <label class="check-item"><input type="checkbox" value="Bujias"><span>Cambio de bujÃ­as</span></label>
  <label class="check-item"><input type="checkbox" value="Valvulas"><span>Reglaje de vÃ¡lvulas</span></label>
  <label class="check-item"><input type="checkbox" value="AceiteCaja"><span>Aceite caja de cambios</span></label>
  <label class="check-item"><input type="checkbox" value="AceiteEmbrague"><span>Aceite embrague</span></label>

  <h3>ğŸ›‘ Frenos</h3>
  <label class="check-item"><input type="checkbox" value="PastillasDel"><span>Pastillas delanteras</span></label>
  <label class="check-item"><input type="checkbox" value="PastillasTras"><span>Pastillas traseras</span></label>
  <label class="check-item"><input type="checkbox" value="LiquidoFrenos"><span>LÃ­quido de frenos</span></label>

  <h3>ğŸŒ¡ï¸ RefrigeraciÃ³n</h3>
  <label class="check-item"><input type="checkbox" value="Anticongelante"><span>Anticongelante</span></label>

  <h3>ğŸ› ï¸ SuspensiÃ³n</h3>
  <label class="check-item"><input type="checkbox" value="Horquilla"><span>Aceite horquillas delanteras</span></label>

  <div class="actions">
    <button class="primary" id="guardarRevision">ğŸ’¾ Guardar</button>
    <button class="primary" id="volverMantenimiento">â¬…ï¸ Volver</button>
  </div>
</div>

<!-- HISTORIAL -->
<div id="historial" class="card hidden">
  <h2>Historial de mantenimiento</h2>
  <ul id="listaHistorial" style="list-style:none;padding:0"></ul>
  <button class="primary" id="volverHistorial">â¬…ï¸ Volver</button>
</div>

<script>
document.addEventListener('DOMContentLoaded',()=>{
  const $=id=>document.getElementById(id);
  const getMotos=()=>JSON.parse(localStorage.getItem('motos')||'[]');
  const setMotos=m=>localStorage.setItem('motos',JSON.stringify(m));

  function show(id){
    ['home','moto','mantenimiento','historial'].forEach(s=>$(s).classList.add('hidden'));
    $(id).classList.remove('hidden');
    if(id==='historial') cargarHistorial();
  }

  function toast(msg,err){
    const t=document.createElement('div');
    t.className='toast'+(err?' error':'');
    t.textContent=msg;
    document.body.appendChild(t);
    requestAnimationFrame(()=>t.classList.add('show'));
    setTimeout(()=>t.remove(),3000);
  }

  function cargar(){
    const ul=$('listaMotos'); ul.innerHTML='';
    const sel=$('motoSeleccionada');
    sel.innerHTML='<option value="">Selecciona una moto</option>';

    getMotos().forEach(m=>{
      const li=document.createElement('li');
      li.style.display='flex';
      li.style.justifyContent='space-between';
      li.style.alignItems='center';
      li.innerHTML=`<span>${m.datos.marca} ${m.datos.modelo||''}</span>`;
      const b=document.createElement('button');
      b.className='danger';
      b.textContent='ğŸ—‘ï¸';
      b.onclick=()=>eliminarMoto(m.id);
      li.appendChild(b);
      ul.appendChild(li);

      const o=document.createElement('option');
      o.value=m.id;
      o.textContent=`${m.datos.marca} ${m.datos.modelo||''}`;
      sel.appendChild(o);
    });
  }

  function guardarMoto(){
    const campos=['marca','modelo','anio','cilindrada','neumaticos','itv'];
    if(campos.some(c=>!$(c).value)){toast('Rellena todos los campos',true);return;}
    const motos=getMotos();
    motos.push({id:'m'+Date.now(),datos:{
      marca:marca.value,modelo:modelo.value,anio:anio.value,
      cilindrada:cilindrada.value,neumaticos:neumaticos.value,itv:itv.value
    },historial:[]});
    setMotos(motos);
    campos.forEach(c=>$(c).value='');
    cargar(); show('home');
  }

  function guardarRevision(){
    const sel=$('motoSeleccionada');
    const kmEl=$('km');
    const fechaEl=$('fecha');
    const obsEl=$('obs');
    const pendEl=$('pendiente');

    if(!sel.value||!kmEl.value||!fechaEl.value){
      toast('Completa los campos',true);return;
    }

    const motos=getMotos();
    const m=motos.find(x=>x.id===sel.value);
    const trabajos=[...document.querySelectorAll('#mantenimiento input[type=checkbox]:checked')].map(c=>c.value);

    m.historial.push({
      km:kmEl.value,
      fecha:fechaEl.value,
      obs:obsEl.value,
      pendiente:pendEl.value,
      trabajos
    });

    setMotos(motos);

    kmEl.value=fechaEl.value=obsEl.value=pendEl.value='';
    document.querySelectorAll('#mantenimiento input[type=checkbox]').forEach(c=>c.checked=false);

    toast('RevisiÃ³n guardada');
    show('home');
  }

  function cargarHistorial(){
    const ul=$('listaHistorial'); ul.innerHTML='';
    const motos=getMotos();
    if(!motos.some(m=>m.historial.length)){
      ul.innerHTML='<li>No hay revisiones registradas</li>';
      return;
    }
    motos.forEach(m=>{
      m.historial.forEach(r=>{
        const li=document.createElement('li');
        li.style.marginBottom='12px';
        li.innerHTML=`
          <strong>${m.datos.marca} ${m.datos.modelo||''}</strong><br>
          ğŸ“… ${r.fecha} Â· ğŸ›£ï¸ ${r.km} km<br>
          ğŸ› ï¸ ${r.trabajos.join(', ')||'Sin checklist'}
        `;
        ul.appendChild(li);
      });
    });
  }

  $('btnMoto').onclick=()=>show('moto');
  $('btnMantenimiento').onclick=()=>show('mantenimiento');
  $('btnHistorial').onclick=()=>show('historial');
  $('volverMoto').onclick=$('volverMantenimiento').onclick=$('volverHistorial').onclick=()=>show('home');
  $('guardarMoto').onclick=guardarMoto;
  $('guardarRevision').onclick=guardarRevision;

  cargar();
});
</script>
</body>
</html>
