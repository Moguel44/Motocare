<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="theme-color" content="#22d3ee">
<title>MotoCare</title>
<link rel="manifest" href="manifest.json">
<style>
:root{--bg:#0b1220;--card:#020617;--accent:#7dd3fc;--border:#1e293b}
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;color:#e5e7eb;margin:0;padding:16px;background:var(--bg);min-height:100vh}
.header{text-align:center;padding:20px 0}
.logo-big{width:120px;height:120px;border-radius:24px;box-shadow:0 8px 20px rgba(0,0,0,.6)}
h1{color:var(--accent);margin:10px 0}
.card{background:rgba(2,6,23,.95);border-radius:18px;padding:20px;margin:16px auto;max-width:720px}
.hidden{display:none}
.menu{display:flex;flex-direction:column;gap:14px}
.menu button{padding:16px;border-radius:16px;border:1px solid var(--border);background:var(--card);color:#e5e7eb;font-size:16px}
input,textarea,select{width:100%;padding:14px;border-radius:12px;border:1px solid var(--border);margin-top:12px;background:var(--card);color:#e5e7eb}
input.error,select.error{border:2px solid #dc2626;box-shadow:0 0 0 2px rgba(220,38,38,.3)}
.actions{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:16px}
button.primary{padding:14px;border-radius:22px;border:2px solid transparent;background:linear-gradient(#111827,#020617) padding-box,linear-gradient(135deg,#c9a227,#7c3aed) border-box;color:#fff;font-weight:600}
button.danger{background:linear-gradient(135deg,#dc2626,#991b1b);color:#fff;border:none;padding:8px 14px;border-radius:14px}
.check-item{display:flex;align-items:center;gap:12px;margin-top:10px}
.toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,#1f2937,#020617);border:1px solid var(--border);color:#e5e7eb;padding:14px 18px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.6);z-index:999;opacity:0;pointer-events:none;transition:opacity .3s, transform .3s}
.toast.show{opacity:1;pointer-events:auto;transform:translateX(-50%) translateY(-6px)}
.toast.error{border:1px solid #dc2626}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:1000}
.modal.hidden{display:none}
.modal-card{background:#020617;border-radius:18px;padding:20px;max-width:360px;width:90%;border:1px solid var(--border)}
.modal-actions{display:flex;gap:12px;margin-top:16px}
.modal-actions button{flex:1;padding:12px;border-radius:14px;font-weight:600}
.modal-actions .cancel{background:#111827;color:#e5e7eb;border:1px solid var(--border)}
.modal-actions .confirm{background:linear-gradient(135deg,#dc2626,#991b1b);color:#fff;border:none}
</style>
</head>
<body>
<div class="header">
  <img src="Mi_Man.png" class="logo-big" alt="MotoCare" />
  <h1>MotoCare</h1>
</div>

<div id="home" class="card">
  <h2>Motos registradas</h2>
  <ul id="listaMotos" style="list-style:none;padding:0"></ul>
  <div class="menu">
    <button id="btnMoto">A√±adir / Editar moto</button>
    <button id="btnMantenimiento">Mantenimiento</button>
    <button id="btnHistorial">Historial</button>
  </div>
</div>

<div id="moto" class="card hidden">
  <h2>Tu moto</h2>
  <input id="marca" placeholder="Marca" />
  <input id="modelo" placeholder="Modelo" />
  <input id="anio" placeholder="A√±o" />
  <input id="cilindrada" placeholder="Cilindrada" />
  <input id="neumaticos" placeholder="Neum√°ticos" />
  <label>Fecha ITV</label>
  <input id="itv" type="date" />
  <div class="actions">
    <button class="primary" id="guardarMoto">üíæ Guardar</button>
    <button class="primary" id="volverMoto">‚¨ÖÔ∏è Volver</button>
  </div>
</div>

<div id="mantenimiento" class="card hidden">
  <h2>Mantenimiento</h2>
  <label>Moto</label>
  <select id="motoSeleccionada">
    <option value="">Selecciona una moto</option>
  </select>
  <input id="km" placeholder="Kil√≥metros" />
  <label>Fecha mantenimiento</label>
  <input id="fecha" type="date" />
  <textarea id="obs" placeholder="Observaciones"></textarea>
  <textarea id="pendiente" placeholder="Pendiente / por hacer"></textarea>

  <h3>üõ¢Ô∏è Motor y transmisi√≥n</h3>
  <div class="check-item"><input type="checkbox" value="Aceite">Cambio de aceite</div>
  <div class="check-item"><input type="checkbox" value="FiltroAceite">Filtro de aceite</div>
  <div class="check-item"><input type="checkbox" value="Bujias">Cambio de buj√≠as</div>
  <div class="check-item"><input type="checkbox" value="Valvulas">Reglaje de v√°lvulas</div>
  <div class="check-item"><input type="checkbox" value="AceiteCaja">Aceite caja de cambios</div>
  <div class="check-item"><input type="checkbox" value="AceiteEmbrague">Aceite embrague</div>

  <h3>üõë Frenos</h3>
  <div class="check-item"><input type="checkbox" value="PastillasDel">Pastillas delanteras</div>
  <div class="check-item"><input type="checkbox" value="PastillasTras">Pastillas traseras</div>
  <div class="check-item"><input type="checkbox" value="LiquidoFrenos">L√≠quido de frenos</div>

  <h3>üå°Ô∏è Refrigeraci√≥n</h3>
  <div class="check-item"><input type="checkbox" value="Anticongelante">Anticongelante</div>

  <h3>üõ†Ô∏è Suspensi√≥n</h3>
  <div class="check-item"><input type="checkbox" value="Horquilla">Aceite horquillas delanteras</div>

  <div class="actions">
    <button class="primary" id="guardarRevision">üíæ Guardar</button>
    <button class="primary" id="volverMantenimiento">‚¨ÖÔ∏è Volver</button>
  </div>
</div>

<div id="confirmModal" class="modal hidden">
  <div class="modal-card">
    <h3>Eliminar moto</h3>
    <p id="confirmText"></p>
    <div class="modal-actions">
      <button class="cancel" id="cancelDelete">Cancelar</button>
      <button class="confirm" id="confirmDelete">Eliminar</button>
    </div>
  </div>
</div>

<div id="historial" class="card hidden">
  <h2>Historial</h2>
  <ul id="listaHistorial" style="list-style:none;padding:0"></ul>
  <button class="primary" id="volverHistorial">‚¨ÖÔ∏è Volver</button>
</div>

<script>
document.addEventListener('DOMContentLoaded',()=>{
  const $=id=>document.getElementById(id);
  const getMotos=()=>JSON.parse(localStorage.getItem('motos')||'[]');
  const setMotos=m=>localStorage.setItem('motos',JSON.stringify(m));

  function mostrar(id){
    ['home','moto','mantenimiento','historial'].forEach(s=>$(s).classList.add('hidden'));
    $(id).classList.remove('hidden');
    if(id==='historial') cargarHistorial();
  }
  function toast(msg,err){const t=document.createElement('div');t.className='toast'+(err?' error':'');t.textContent=msg;document.body.appendChild(t);requestAnimationFrame(()=>t.classList.add('show'));setTimeout(()=>{t.classList.remove('show');setTimeout(()=>t.remove(),300)},3000)}

  function cargar(){
    const ul=$('listaMotos');ul.innerHTML='';
    const sel=$('motoSeleccionada');sel.innerHTML='<option value="">Selecciona una moto</option>';
    const motos=getMotos();
    if(!motos.length){ul.innerHTML='<li>No hay motos registradas</li>';return;}
    motos.forEach(m=>{
      const li=document.createElement('li');li.style.display='flex';li.style.justifyContent='space-between';
      const s=document.createElement('span');s.textContent=m.datos.marca+' '+(m.datos.modelo||'');
      const b=document.createElement('button');b.className='danger';b.textContent='üóëÔ∏è';b.onclick=()=>eliminarMoto(m.id);
      li.append(s,b);ul.appendChild(li);
      const o=document.createElement('option');o.value=m.id;o.textContent=s.textContent;sel.appendChild(o);
    });
  }

  function guardarMoto(){
    const campos=['marca','modelo','anio','cilindrada','neumaticos','itv'];
    let ok=true;campos.forEach(c=>{$(c).classList.remove('error');if(!$(c).value){$(c).classList.add('error');ok=false;}});
    if(!ok){toast('‚ö†Ô∏è Rellena todos los campos',true);return;}
    const motos=getMotos();motos.push({id:'m'+Date.now(),datos:{marca:marca.value,modelo:modelo.value,anio:anio.value,cilindrada:cilindrada.value,neumaticos:neumaticos.value,itv:itv.value},historial:[]});
    setMotos(motos);campos.forEach(c=>$(c).value='');toast('‚úÖ Moto guardada');cargar();mostrar('home');
  }

  let pend=null;
  function eliminarMoto(id){const m=getMotos().find(x=>x.id===id);if(!m){toast('Moto no encontrada',true);return;}pend=id;confirmText.textContent=`Eliminar ${m.datos.marca} ${m.datos.modelo||''} y su historial?`;confirmModal.classList.remove('hidden');}

  confirmDelete.onclick=()=>{if(!pend)return;setMotos(getMotos().filter(m=>m.id!==pend));pend=null;confirmModal.classList.add('hidden');toast('üóëÔ∏è Moto eliminada');cargar();};
  cancelDelete.onclick=()=>{pend=null;confirmModal.classList.add('hidden');};

  function cargarHistorial(){
    const ul = $('listaHistorial');
    ul.innerHTML = '';
    const motos = getMotos();
    if(!motos.length){ ul.innerHTML='<li>No hay motos</li>'; return; }

    motos.forEach(m=>{
      if(!m.historial || !m.historial.length) return;
      const h=document.createElement('li');
      h.style.marginBottom='16px';
      h.innerHTML = `<strong>${m.datos.marca} ${m.datos.modelo||''}</strong>`;
      ul.appendChild(h);

      m.historial.forEach(r=>{
        const li=document.createElement('li');
        li.style.marginLeft='16px';
        li.style.marginTop='6px';
        li.innerHTML = `üõ†Ô∏è ${r.fecha} ‚Äì ${r.km} km<br><small>${r.trabajos.join(', ')||'Sin checklist'}</small>`;
        ul.appendChild(li);
      });
    });
  }

  function guardarRevision(){
    const sel = $('motoSeleccionada');
    const kmEl = $('km');
    const fechaEl = $('fecha');
    const obsEl = $('obs');
    const pendEl = $('pendiente');

    if(!sel.value || !kmEl.value || !fechaEl.value){
      toast('‚ö†Ô∏è Completa moto, km y fecha',true);
      return;
    }

    const motos = getMotos();
    const m = motos.find(x => x.id === sel.value);
    if(!m){ toast('Moto no v√°lida', true); return; }

    const trabajos = [...document.querySelectorAll('#mantenimiento input[type=checkbox]:checked')]
      .map(c => c.value);

    m.historial.push({
      km: kmEl.value,
      fecha: fechaEl.value,
      obs: obsEl.value,
      pendiente: pendEl.value,
      trabajos
    });

    setMotos(motos);

    kmEl.value = '';
    fechaEl.value = '';
    obsEl.value = '';
    pendEl.value = '';
    document.querySelectorAll('#mantenimiento input[type=checkbox]').forEach(c => c.checked = false);

    toast('‚úÖ Revisi√≥n guardada correctamente');
    cargar();
    mostrar('home');
  }

  btnMoto.onclick=()=>mostrar('moto');
  btnMantenimiento.onclick=()=>mostrar('mantenimiento');
  btnHistorial.onclick=()=>mostrar('historial');
  volverMoto.onclick=()=>mostrar('home');
  volverMantenimiento.onclick=()=>mostrar('home');
  volverHistorial.onclick=()=>mostrar('home');
  $('guardarMoto').onclick = guardarMoto;
  $('guardarRevision').onclick = guardarRevision;

  cargar();
});
</script>
</body>
</html>
