<!DOCTYPE html>
<html lang="es">
<head>
<link rel="manifest" href="manifest.json">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MotoCare</title>

<style>
:root{
  --bg:#0b1220;
  --card:#020617;
  --accent:#7dd3fc;
  --border:#1e293b;
}
body{
  margin:0;
  padding:16px;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
  background:var(--bg);
  color:#e5e7eb;
}
.header{text-align:center;margin-bottom:20px}
.logo-big{width:110px;height:110px;border-radius:22px}
h1{color:var(--accent);margin:10px 0}
.card{
  max-width:720px;
  margin:0 auto 20px;
  padding:20px;
  background:rgba(2,6,23,.95);
  border-radius:18px;
}
.hidden{display:none}
input,textarea,select{
  width:100%;
  margin-top:12px;
  padding:14px;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:12px;
  color:#e5e7eb;
}
.actions{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
  margin-top:18px;
}
button.primary{
  padding:14px;
  border-radius:22px;
  border:2px solid transparent;
  background:
    linear-gradient(#020617,#020617) padding-box,
    linear-gradient(135deg,#c9a227,#7c3aed) border-box;
  color:#fff;
  font-weight:600;
}
button.danger{
  background:#991b1b;
  color:#fff;
  border:none;
  padding:6px 10px;
  border-radius:12px;
}
.check-item{
  display:grid;
  grid-template-columns:26px 1fr;
  align-items:center;
  gap:12px;
  margin:10px 0;
}
.check-item input{width:20px;height:20px}
.toast{
  position:fixed;
  bottom:24px;
  left:50%;
  transform:translateX(-50%);
  background:#020617;
  border:1px solid var(--border);
  padding:14px 18px;
  border-radius:16px;
  opacity:0;
  transition:.3s;
}
.toast.show{opacity:1}
.toast.error{border-color:#dc2626}
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:flex;
  align-items:center;
  justify-content:center;
}
.modal.hidden{display:none}
.modal-card{
  background:#020617;
  padding:20px;
  border-radius:18px;
  max-width:360px;
  width:90%;
}
.modal-actions{
  display:flex;
  gap:12px;
  margin-top:16px;
}
.modal-actions .confirm{
  background:#991b1b;
  color:#fff;
  border:none;
}
</style>
</head>

<body>

<div class="header">
  <img src="Mi_Man.png" alt="MotoCare" class="logo-big">
  <h1>MotoCare</h1>
</div>

<!-- HOME -->
<div id="home" class="card">
  <h2>Motos registradas</h2>
  <ul id="listaMotos"></ul>

  <div class="actions">
    <button class="primary" id="btnMoto">â• Moto</button>
    <button class="primary" id="btnMantenimiento">ğŸ› ï¸ Mantenimiento</button>
  </div>

  <div class="actions">
    <button class="primary" id="btnBackup">ğŸ’¾ Exportar backup</button>
    <button class="primary" id="btnRestore">ğŸ“‚ Importar backup</button>
  </div>

  <button class="primary" id="btnHistorial">ğŸ“œ Historial</button>
</div>

<input type="file" id="fileRestore" accept=".json" class="hidden">

<!-- MOTO -->
<div id="moto" class="card hidden">
  <input id="marca" placeholder="Marca">
  <input id="modelo" placeholder="Modelo">
  <input id="anio" placeholder="AÃ±o">
  <input id="cilindrada" placeholder="Cilindrada">
  <input id="neumaticos" placeholder="NeumÃ¡ticos">
  <label>Fecha ITV</label>
  <input id="itv" type="date">
  <div class="actions">
    <button class="primary" id="guardarMoto">Guardar</button>
    <button class="primary" id="volverMoto">Volver</button>
  </div>
</div>

<!-- MANTENIMIENTO -->
<div id="mantenimiento" class="card hidden">
  <select id="motoSeleccionada"></select>
  <input id="km" placeholder="KilÃ³metros">
  <input id="fecha" type="date">

  <h3>ğŸ›¢ï¸ Motor y transmisiÃ³n</h3>
  <label class="check-item"><input type="checkbox" value="Aceite">Cambio de aceite</label>
  <label class="check-item"><input type="checkbox" value="Filtro aceite">Filtro de aceite</label>
  <label class="check-item"><input type="checkbox" value="BujÃ­as">BujÃ­as</label>
  <label class="check-item"><input type="checkbox" value="VÃ¡lvulas">Reglaje de vÃ¡lvulas</label>
  <label class="check-item"><input type="checkbox" value="Aceite caja">Aceite caja cambios</label>

  <h3>ğŸ›‘ Frenos</h3>
  <label class="check-item"><input type="checkbox" value="Pastillas del.">Pastillas delanteras</label>
  <label class="check-item"><input type="checkbox" value="Pastillas tras.">Pastillas traseras</label>
  <label class="check-item"><input type="checkbox" value="LÃ­quido frenos">LÃ­quido de frenos</label>

  <h3>ğŸŒ¡ï¸ RefrigeraciÃ³n</h3>
  <label class="check-item"><input type="checkbox" value="Anticongelante">Anticongelante</label>

  <h3>ğŸ› ï¸ SuspensiÃ³n</h3>
  <label class="check-item"><input type="checkbox" value="Horquilla">Aceite horquilla</label>

  <div class="actions">
    <button class="primary" id="guardarRevision">Guardar</button>
    <button class="primary" id="volverMantenimiento">Volver</button>
  </div>
</div>

<!-- HISTORIAL -->
<div id="historial" class="card hidden">
  <select id="historialMoto"></select>
  <ul id="listaHistorial"></ul>
  <div class="actions">
    <button class="primary" id="btnPDF">ğŸ“„ PDF</button>
    <button class="primary" id="volverHistorial">Volver</button>
  </div>
</div>

<!-- MODAL EDITAR -->
<div id="editModal" class="modal hidden">
  <div class="modal-card">
    <input type="date" id="editFecha">
    <input id="editKm">
    <textarea id="editTrabajos"></textarea>
    <div class="modal-actions">
      <button id="cancelEdit">Cancelar</button>
      <button class="confirm" id="saveEdit">Guardar</button>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded',()=>{
const $=id=>document.getElementById(id);
const { jsPDF } = window.jspdf;

const getMotos=()=>JSON.parse(localStorage.getItem('motos')||'[]');
const setMotos=m=>localStorage.setItem('motos',JSON.stringify(m));

let editMotoId=null, editRevisionIndex=null;

/* ===== AÃ‘ADIDO ===== */
let borrarId = null;
// # MotoCare â€” ELIMINA MOTO Y TODO SU HISTORIAL
function eliminarMotoConfirmada(){
  setMotos(getMotos().filter(m => m.id !== borrarId));
  cargar();
}
/* ===== FIN AÃ‘ADIDO ===== */

function toast(msg,err){
  const t=document.createElement('div');
  t.className='toast'+(err?' error':'');
  t.textContent=msg;
  document.body.appendChild(t);
  requestAnimationFrame(()=>t.classList.add('show'));
  setTimeout(()=>t.remove(),3000);
}

/* â€¦ EL RESTO DE TU JS SIGUE EXACTAMENTE IGUAL â€¦ */

cargar();
solicitarNotificaciones();
});
</script>
</body>
</html>
