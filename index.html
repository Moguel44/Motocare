<!DOCTYPE html><html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="theme-color" content="#22d3ee">
<title>MotoCare</title>
<link rel="manifest" href="manifest.json">
<style>
:root{--bg:#0f172a;--card:#020617;--accent:#22d3ee;--muted:#94a3b8;--border:#334155}
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;color:#e5e7eb;margin:0;padding:16px;background:var(--bg);min-height:100vh}
body::before{content:"";position:fixed;inset:0;background:rgba(2,6,23,.85);z-index:-1}
.header{position:sticky;top:0;z-index:10;text-align:center;padding:20px 0;background:rgba(2,6,23,.95);backdrop-filter:blur(8px)}
.logo-big{width:140px;height:140px;border-radius:28px;box-shadow:0 12px 30px rgba(0,0,0,.7);margin-bottom:8px}
h1{color:var(--accent);margin:6px 0 4px 0;font-size:28px}
.subtitle{opacity:.8;margin:0;font-size:14px}
.menu{display:flex;flex-direction:column;gap:12px;margin-top:24px}
.menu button{background:var(--card);color:#e5e7eb;border:1px solid var(--border);padding:16px;border-radius:16px;font-size:16px;text-align:left}
.card{background:rgba(2,6,23,.92);border-radius:18px;padding:20px;margin-top:20px;position:relative;z-index:1}
.hidden{display:none}
input,textarea,select{width:100%;box-sizing:border-box;padding:14px 16px;border-radius:12px;border:1px solid var(--border);margin-top:12px;background:var(--card);color:#e5e7eb}
label{display:flex;align-items:flex-start;gap:10px;margin:10px 0}
label input[type="checkbox"]{margin-top:3px;flex:0 0 auto}
.checklist{display:grid;grid-template-columns:1fr;row-gap:6px}
@media (min-width:480px){.checklist{grid-template-columns:1fr 1fr;column-gap:16px}}
button.primary{
  background:linear-gradient(135deg,var(--accent),#38bdf8);
  color:#020617;
  border:none;
  padding:16px;
  border-radius:18px;
  font-size:16px;
  font-weight:600;
  width:100%;
  box-shadow:0 8px 20px rgba(34,211,238,.35);
}button.primary.danger{ background:linear-gradient(135deg,#ef4444,#991b1b); color:#fff; box-shadow:0 8px 20px rgba(239,68,68,.35); } #listaHistorial{list-style:none;padding:0} @media print{ body{background:#fff;color:#000} body::before,.menu,.volver,#btnPdf,#btnGuardarPdf,#btnEmail,select,.header{display:none!important} .card{box-shadow:none;border:none;margin:0;padding:0} h1,h2,h3{color:#000} #historial{display:block!important} #listaHistorial li{margin-bottom:12px} #pdfHeader{display:block!important} } </style>

</head>
<body><div class="header">
  <img src="./Mi_Man.png" class="logo-big" alt="MotoCare" />
  <h1>MotoCare</h1>
  <p class="subtitle">Control total de tu moto</p>
</div><div id="home">
  <div class="card">
    <label>ğŸï¸ Moto activa</label>
    <select id="selectorMoto"></select>
  </div>
  <div id="resumen" class="card"></div>
  <div class="menu">
    <button data-target="moto">ğŸï¸ Tu moto</button>
    <button data-target="mantenimiento">ğŸ”§ Mantenimiento</button>
    <button data-target="historial">ğŸ“œ Historial</button>
  </div>
</div><div id="moto" class="card hidden">
  <h2>ğŸï¸ Tu moto</h2>
  <input id="marca" placeholder="Marca" />
  <input id="modelo" placeholder="Modelo" />
  <input id="anio" placeholder="AÃ±o" />
  <input id="cilindrada" placeholder="Cilindrada" />
  <input id="neumaticos" placeholder="NeumÃ¡ticos" />
  <input id="itv" placeholder="ITV" />  <div style="display:flex;gap:12px;margin-top:16px">
    <button class="primary" id="guardarMoto">ğŸ’¾ Guardar moto</button>
    <button class="primary volver">â†©ï¸ Volver</button>
  </div>  <div style="display:flex;flex-direction:column;gap:12px;margin-top:16px">
    <button class="primary" id="btnNuevaMoto">â• Nueva moto</button>
    <button class="primary" id="btnEditarMoto">âœï¸ Editar moto</button>
    <button class="primary danger" id="btnBorrarMoto">ğŸ—‘ï¸ Eliminar moto</button>
  </div>
</div><div id="mantenimiento" class="card hidden">
  <h2>Mantenimiento</h2>
  <input id="km" placeholder="KilÃ³metros" />
  <input id="fecha" placeholder="Fecha" />
  <textarea id="obs" placeholder="Observaciones"></textarea>
  <textarea id="pendiente" placeholder="Pendiente"></textarea>
  <label><input type="checkbox" class="rev" value="Aceite">Aceite</label>
  <label><input type="checkbox" class="rev" value="Frenos">Frenos</label>
  <button class="primary" id="guardarRevision">Guardar revisiÃ³n</button>
  <button class="primary volver">Volver</button>
</div><div id="historial" class="card hidden">
  <div id="pdfHeader" style="display:none;margin-bottom:16px;text-align:center">
    <img src="./Mi_Man.png" alt="MotoCare" style="width:80px;height:80px;border-radius:16px;margin-bottom:8px" />
    <h1 style="margin:0">MotoCare</h1>
    <p id="pdfMotoDatos" style="margin:6px 0 0 0"></p>
  </div>  <div style="display:flex;gap:12px;flex-wrap:wrap;margin-bottom:12px">
    <button class="primary" id="btnPdf">ğŸ“„ Exportar PDF</button>
    <button class="primary" id="btnGuardarPdf">ğŸ’¾ Guardar PDF</button>
    <button class="primary" id="btnEmail">âœ‰ï¸ Enviar por correo</button>
  </div>  <h2>Historial</h2>
  <ul id="listaHistorial"></ul>
  <button class="primary volver">Volver</button>
</div><script>
document.addEventListener('DOMContentLoaded', function () {
  const $ = id => document.getElementById(id);
  const getMotos = () => JSON.parse(localStorage.getItem('motos') || '[]');
  const setMotos = m => localStorage.setItem('motos', JSON.stringify(m));
  const getActiva = () => getMotos().find(m => m.id === localStorage.getItem('motoActivaId'));

  function actualizarSelector() {
    const s = $('selectorMoto');
    const motos = getMotos();
    const act = localStorage.getItem('motoActivaId');
    s.innerHTML = motos.map(m => `<option value="${m.id}" ${m.id === act ? 'selected' : ''}>${m.datos.marca} ${m.datos.modelo}</option>`).join('');
  }

  function cargarResumen() {
    const r = $('resumen');
    const m = getActiva();
    if (!m) { r.innerHTML = '<p>No hay moto</p>'; return; }
    r.innerHTML = `<h3>${m.datos.marca} ${m.datos.modelo}</h3>`;
  }

  function mostrar(id) {
    ['home', 'moto', 'mantenimiento', 'historial'].forEach(s => $(s).classList.add('hidden'));
    $(id).classList.remove('hidden');
  }

  function volver() {
    mostrar('home');
    cargarResumen();
  }

  function prepararPdf(){
    const m=getActiva();
    if(!m) return;
    $('pdfMotoDatos').innerText = `${m.datos.marca} ${m.datos.modelo} Â· ${m.datos.anio||''} Â· ${m.datos.cilindrada||''}`;
  }

  function generarTextoHistorial(){
    const m=getActiva();
    if(!m) return 'Sin datos';
    let txt=`Moto: ${m.datos.marca} ${m.datos.modelo}\n`;
    (m.historial||[]).forEach((r,i)=>{
      txt+=`\n#${i+1} - ${r.fecha||''} - ${r.km||''} km`;
    });
    return txt;
  }

  $('btnPdf').onclick=()=>{ prepararPdf(); window.print(); };
  $('btnGuardarPdf').onclick=()=>{ prepararPdf(); alert('Elige Guardar como PDF'); window.print(); };
  $('btnEmail').onclick=()=>{
    const body=encodeURIComponent(generarTextoHistorial());
    window.location.href=`mailto:?subject=Historial MotoCare&body=${body}`;
  };

  document.querySelectorAll('.menu button').forEach(b => b.onclick = () => mostrar(b.dataset.target));
  document.querySelectorAll('.volver').forEach(b => b.onclick = volver);

  $('btnNuevaMoto').onclick = () => {
    ['marca','modelo','anio','cilindrada','neumaticos','itv'].forEach(i => $(i).value='');
  };

  $('guardarMoto').onclick = () => {
    if (!$('marca').value) return alert('Marca requerida');
    const motos = getMotos();
    const nueva = {
      id: crypto.randomUUID(),
      datos: {
        marca:$('marca').value,
        modelo:$('modelo').value,
        anio:$('anio').value,
        cilindrada:$('cilindrada').value,
        neumaticos:$('neumaticos').value,
        itv:$('itv').value
      },
      historial: []
    };
    motos.push(nueva);
    setMotos(motos);
    localStorage.setItem('motoActivaId', nueva.id);
    actualizarSelector();
    volver();
  };

  $('selectorMoto').onchange = e => {
    localStorage.setItem('motoActivaId', e.target.value);
    cargarResumen();
  };

  actualizarSelector();
  cargarResumen();
});
</script><!-- NOTA: El registro del Service Worker se elimina aquÃ­ para evitar SecurityError
     en entornos restringidos (sandbox, vista previa, algunos navegadores).
     En producciÃ³n (GitHub Pages / HTTPS real) se debe registrar en un archivo separado. --></body>
</html>
