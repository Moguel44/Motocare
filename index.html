<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="theme-color" content="#22d3ee">
<title>MotoCare</title>
<link rel="manifest" href="manifest.json">
<style>
:root{--bg:#0f172a;--card:#020617;--accent:#22d3ee;--border:#334155}
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;color:#e5e7eb;margin:0;padding:16px;background:var(--bg);min-height:100vh}
body::before{content:"";position:fixed;inset:0;background:rgba(2,6,23,.85);z-index:-1}
.header{position:sticky;top:0;z-index:10;text-align:center;padding:20px 0;background:rgba(2,6,23,.95);backdrop-filter:blur(8px)}
.logo-big{width:140px;height:140px;border-radius:28px;box-shadow:0 12px 30px rgba(0,0,0,.7);margin-bottom:8px}
h1{color:var(--accent);margin:6px 0 4px 0;font-size:28px}
.subtitle{opacity:.8;margin:0;font-size:14px}
.menu{display:flex;flex-direction:column;gap:12px;margin-top:24px}
.menu button{background:var(--card);color:#e5e7eb;border:1px solid var(--border);padding:16px;border-radius:16px;font-size:16px;text-align:left}
.card{background:rgba(2,6,23,.92);border-radius:18px;padding:20px;margin-top:20px}
.hidden{display:none}
input,textarea,select{width:100%;box-sizing:border-box;padding:14px 16px;border-radius:12px;border:1px solid var(--border);margin-top:12px;background:var(--card);color:#e5e7eb}
button.primary{background:linear-gradient(135deg,var(--accent),#38bdf8);color:#020617;border:none;padding:16px;border-radius:18px;font-size:16px;font-weight:600;width:100%;margin-top:12px}
.actions{display:flex;flex-direction:column;gap:14px;margin-top:20px}
.checklist{display:flex;flex-direction:column;gap:12px;margin-top:16px}
.check-item{display:flex;align-items:center;gap:12px}
.check-item span{flex:1}
#listaHistorial{list-style:none;padding:0}
</style>
</head>
<body>

<div class="header">
  <img src="./Mi_Man.png" class="logo-big" alt="MotoCare" />
  <h1>MotoCare</h1>
  <p class="subtitle">Control total de tu moto</p>
</div>

<div id="home">
  <div class="card">
    <label>Moto activa</label>
    <select id="selectorMoto"></select>
  </div>
  <div id="resumen" class="card"></div>
  <div class="menu">
    <button data-target="moto">Tu moto</button>
    <button data-target="mantenimiento">Mantenimiento</button>
    <button data-target="historial">Historial</button>
  </div>
</div>

<div id="moto" class="card hidden">
  <h2>Tu moto</h2>
  <input id="marca" placeholder="Marca" />
  <input id="modelo" placeholder="Modelo" />
  <input id="anio" placeholder="Año" />
  <input id="cilindrada" placeholder="Cilindrada" />
  <input id="neumaticos" placeholder="Neumáticos" />
  <input id="itv" placeholder="ITV" />
  <div class="actions">
    <button class="primary" id="guardarMoto">Guardar moto</button>
    <button class="primary volver">Volver</button>
  </div>
</div>

<div id="mantenimiento" class="card hidden">
  <h2>Mantenimiento</h2>
  <input id="km" placeholder="Kilómetros" />
  <input id="fecha" placeholder="Fecha" />
  <textarea id="obs" placeholder="Observaciones"></textarea>
  <textarea id="pendiente" placeholder="Pendiente"></textarea>
  <div class="checklist">
    <label class="check-item"><input type="checkbox" class="rev" value="Cambio de aceite"><span>Cambio de aceite</span></label>
    <label class="check-item"><input type="checkbox" class="rev" value="Filtro de aceite"><span>Filtro de aceite</span></label>
    <label class="check-item"><input type="checkbox" class="rev" value="Filtro de aire"><span>Filtro de aire</span></label>
    <label class="check-item"><input type="checkbox" class="rev" value="Bujias"><span>Bujías</span></label>
    <label class="check-item"><input type="checkbox" class="rev" value="Pastillas de freno"><span>Pastillas de freno</span></label>
    <label class="check-item"><input type="checkbox" class="rev" value="Liquido de frenos"><span>Líquido de frenos</span></label>
    <label class="check-item"><input type="checkbox" class="rev" value="Anticongelante"><span>Anticongelante</span></label>
    <label class="check-item"><input type="checkbox" class="rev" value="Cambio de neumáticos"><span>Cambio de neumáticos</span></label>
  </div>
  <div class="actions">
    <button class="primary" id="guardarRevision">Guardar revisión</button>
    <button class="primary volver">Volver</button>
  </div>
</div>

<div id="historial" class="card hidden">
  <h2>Historial</h2>
  <ul id="listaHistorial"></ul>
  <button class="primary volver">Volver</button>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const $ = id => document.getElementById(id);
  const getMotos = () => JSON.parse(localStorage.getItem('motos') || '[]');
  const setMotos = m => localStorage.setItem('motos', JSON.stringify(m));
  const getActiva = () => getMotos().find(m => m.id === localStorage.getItem('motoActivaId'));

  function mostrar(id){
    ['home','moto','mantenimiento','historial'].forEach(s=>$(s).classList.add('hidden'));
    $(id).classList.remove('hidden');
  }

  document.querySelectorAll('.menu button').forEach(b=>b.onclick=()=>mostrar(b.dataset.target));
  document.querySelectorAll('.volver').forEach(b=>b.onclick=()=>mostrar('home'));

  $('guardarMoto').onclick = () => {
    if(!$('marca').value) return alert('Marca requerida');
    const motos=getMotos();
    const moto={id:crypto.randomUUID(),datos:{marca:$('marca').value,modelo:$('modelo').value},historial:[]};
    motos.push(moto);
    setMotos(motos);
    localStorage.setItem('motoActivaId', moto.id);
    cargar();
    mostrar('home');
  };

  $('guardarRevision').onclick = () => {
    const m=getActiva();
    if(!m) return alert('No hay moto');
    const revs=[...document.querySelectorAll('.rev:checked')].map(c=>c.value);
    if(!revs.length) return alert('Marca al menos una revisión');
    m.historial.push({km:$('km').value,fecha:$('fecha').value,revs});
    setMotos(getMotos().map(x=>x.id===m.id?m:x));
    cargar();
    mostrar('home');
  };

  function cargar(){
    const s=$('selectorMoto');
    const motos=getMotos();
    s.innerHTML=motos.map(m=>`<option value="${m.id}">${m.datos.marca} ${m.datos.modelo}</option>`).join('');
    const m=getActiva();
    $('resumen').innerHTML=m?`<h3>${m.datos.marca} ${m.datos.modelo}</h3>`:'';
    const ul=$('listaHistorial');
    ul.innerHTML='';
    if(m) m.historial.forEach(r=>{
      const li=document.createElement('li');
      li.textContent=`${r.fecha||''} - ${r.km||''} km - ${r.revs.join(', ')}`;
      ul.appendChild(li);
    });
  }

  $('selectorMoto').onchange=e=>{localStorage.setItem('motoActivaId', e.target.value);cargar();};
  cargar();
});
</script>
</body>
</html>
